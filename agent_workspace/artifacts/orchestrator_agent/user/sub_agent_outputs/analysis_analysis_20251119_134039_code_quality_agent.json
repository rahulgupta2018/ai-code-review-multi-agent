"{\n    \"agent\": \"code_quality_agent\",\n    \"complexity_analysis\": {\n        \"summary\": \"The function exhibits moderate complexity with a cyclomatic complexity of 5 due to the retry logic and exception handling. The nesting depth is low, primarily driven by asynchronous event processing.\",\n        \"details\": [\n            {\n                \"metric\": \"cyclomatic_complexity\",\n                \"value\": 5\n            },\n            {\n                \"metric\": \"nesting_depth\",\n                \"value\": 3\n            }\n        ]\n    },\n    \"code_quality_assessment\": {\n        \"summary\": \"The code is functional and follows a clear sequential pipeline pattern. However, there are opportunities to improve modularity, error handling clarity, and adherence to best practices.\",\n        \"issues\": [\n            {\n                \"type\": \"modularity\",\n                \"description\": \"Large function with multiple responsibilities (runner creation, session management, event processing). Consider breaking into smaller functions for better separation of concerns.\"\n            },\n            {\n                \"type\": \"error_handling\",\n                \"description\": \"Retry logic and error handling are duplicated in the success and failure branches. Consolidate common retry behavior to reduce duplication.\",\n            }\n        ]\n    },\n    \"best_practices_evaluation\": {\n        \"summary\": \"The code demonstrates good use of async/await for non-blocking operations, but lacks explicit type annotations beyond docstrings and could benefit from more comprehensive error handling and logging.\",\n        \"violations\": [\n            {\n                \"type\": \"missing_type_annotations\",\n                \"description\": \"Function parameters lack explicit typing (e.g., `agent`, `code_submission` should be annotated).\"\n            }\n        ]\n    },\n    \"recommendations\": [\n        {\n            \"action\": \"Add type annotations to all function arguments and return types.\",\n            \"example\": \"async def run_agent_sequential(agent: Agent, code_submission: str, session_service: SessionService, agent_name: str, max_retries: int = 3) -> str:\"\n        },\n        {\n            \"action\": \"Extract runner creation logic into a separate function to improve readability and reusability.\",\n            \"example\": \"def create_runner(agent, app_name='code_review_sequential', session_service=session_service): ...\"\n        },\n        {\n            \"action\": \"Centralize retry logic in its own helper function to avoid duplication across success and failure branches.\",\n            \"example\": \"async def perform_retry(runner_func, *args, **kwargs) -> str:\"\n        }\n    ]\n}"